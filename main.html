<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>
        Production
    </title>
</head>


<style>
    .main-grid{
        display: grid;
        grid-template-columns: 80% 20%;
        grid-template-rows: 80%;
    }
    .image-grid {
        display: grid;
        grid-template-columns: 25% 25% 25% 25%;
        grid-template-rows: 25% 25% 25% 25%;
        gap: 1px;
    }
    .side-column{
        display: flex;
        flex-direction: column;
        justify-self: center;
        justify-content: space-between;
        width: 75%;
        height: 100%;
    }
    .done-button{
        width: 100%;
        height: 100%;
        margin: auto;
    }
    .button-container{
        width: 100%;
        height: 5%;
        display: flex;
        justify-content: center;
        align-items: center;
    }
</style>

<body>

<h1>
    Distractor Identification
</h1>

<div class="main-grid">
    <div class="image-grid">
        <div class="grid-item">
            <img id="00" src="images/13519159331282190511145898933210408393_0.jpg" title="00" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="01" src="images/13519159331282190511145898933210408393_4.jpg" title="01" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="02" src="images/13519159331282190511145898933210408393_8.jpg" title="02" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="03" src="images/13519159331282190511145898933210408393_12.jpg" title="03" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="10" src="images/13519159331282190511145898933210408393_1.jpg" title="10" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="11" src="images/13519159331282190511145898933210408393_5.jpg" title="11" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="12" src="images/13519159331282190511145898933210408393_9.jpg" title="12" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="13" src="images/13519159331282190511145898933210408393_13.jpg" title="13" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="20" src="images/13519159331282190511145898933210408393_2.jpg" title="20" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="21" src="images/13519159331282190511145898933210408393_6.jpg" title="21" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="22" src="images/13519159331282190511145898933210408393_10.jpg" title="22" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="23" src="images/13519159331282190511145898933210408393_14.jpg" title="23" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="30" src="images/13519159331282190511145898933210408393_3.jpg" title="30" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="31" src="images/13519159331282190511145898933210408393_7.jpg" title="31" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="32" src="images/13519159331282190511145898933210408393_11.jpg" title="32" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
        <div class="grid-item">
            <img id="33" src="images/13519159331282190511145898933210408393_15.jpg" title="33" style="width: 100%; height: 100%; filter: grayscale(0%);" onclick="getImgPos(this.id)">
        </div>
    </div>
    <div class="side-column" style="background-color: #e0e0e0">
        <div>
            This text will be instructions later
        </div>
        <div class="button-container">
            <button class="done-button" onclick="getNewImagePath()">
                Done
            </button>
        </div>
    </div>
</div>




</body>
</html>

<script>
    //Declare Boolean Array
    let row1 = [0,0,0,0]
    let row2 = [0,0,0,0]
    let row3 = [0,0,0,0]
    let row4 = [0,0,0,0]
    let BoolVals = [row1,row2,row3,row4]

    let QuadRow0 = [0,4,8,12]
    let QuadRow1 = [1,5,9,13]
    let QuadRow2 = [2,6,10,14]
    let QuadRow3 = [3,7,11,15]
    let Quadants = [QuadRow0,QuadRow1,QuadRow2,QuadRow3]


    let NewImagePath;
    let FinalImagePath = "Tree.jpg";

    let CurrentImgBoolean = 0

    let RowNum = 0
    let ColNum = 0
    function getImgPos(id){
        console.log("Get image position called")

        RowNum = id.substring(0,1)
        ColNum = id.substring(1,2)
        greyImage(RowNum,ColNum,id)

    }
    function greyImage(RN,CN,id){
        console.log("Grey Image called")
        CurrentImgBoolean = BoolVals[RN][CN]

        if (CurrentImgBoolean === 0){
            document.getElementById(id).style.filter = "grayscale(100%)"
            BoolVals[RN][CN] = 1
        }
        else{
            document.getElementById(id).style.filter = "grayscale(0%)"
            BoolVals[RN][CN] = 0
        }
        console.log(BoolVals)
    }

    function getNewImagePath(){
        //Server call to get the new path
        //Call python script to move the files to the local directory
        //Strip out the last two characters from the path to make it easier to append later
        //NewImagePath = NewImagePath.substring(0, text.length-6) //Cut end off of path to append each of them in getAllImageIDs


        getAllImageIDs()
        sendBooleanData()
    }
    function getAllImageIDs (){
        let IMGid = '00';
        let QuadID = 0;
        for (let row = 0; row < 4; row++){
            for (let col = 0; col < 4; col++){
                IMGid = row.toString().concat(col.toString())
                QuadID = Quadants[row][col]
                setFinalImagePath(IMGid,QuadID)
            }
        }
    }

    function setFinalImagePath(ImageID, QuadrantID){
        //FinalImagePath = NewImagePath.concat("_" + QuadrantID.toString()+ ".jpg")
        changeImage(ImageID,QuadrantID)

    }

    function changeImage(id){
        //console.log(typeof id)
        //console.log(document.getElementById(id))

        document.getElementById(id).src=FinalImagePath
    }

    function sendBooleanData(){
        console.log(BoolVals)
        //Send the updated boolean matrix to the server
        resetBooleans()
    }

    function resetBooleans(){
        console.log(BoolVals)
        for (let row = 0; row < 4;row++){
            for (let col = 0; col < 4; col++){
                if (BoolVals[row][col] === 1){
                    BoolVals[row][col] = 0
                    document.getElementById(row.toString().concat(col.toString())).style.filter = "grayscale(0%)"
                }
            }
        }
        console.log(BoolVals)
    }


</script>